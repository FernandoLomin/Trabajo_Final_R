---
title: "Proyecto Final de R"
author: "Fernando Lominchar"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output:
  rmdformats::material:
    cards: false
    self_contained: true
    thumbnails: true
    lightbox: true
    gallery: false
    highlight: tango
    
---


# Expresiones Regulares y Recursos de R Markdown.

```{r library, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(reshape2)
library(pander)
library(rvest)
library(dplyr)
library(plotly)
library(knitr)
library(rmdformats)
library(tmap)
library(ggvis)
```

## Comentarios sobre Expresiones Regulares

Tenemos dos páginas sobre expresiones regulares:

* [RIP tutorial](https://riptutorial.com/es/r/topic/5748/expresiones-regulares--expresiones-regulares-)
* [Stringr](https://stringr.tidyverse.org/articles/regular-expressions.html)

En la primera página **Rip tutorial**, cuenta con unas explicaciones ciertamente claras, además en español, útiles para aquellas personas que comienzan a estudiar las expresiones regulares. Es bastante intuitiva, cubre las principales dudas que pueden surgir, posee un apartado donde explica las diferencias existentes en cada idioma y cuenta con un pdf gratuito para poder tener siempre a mano la informaciÃ³n.

Respecto a la página de **Stringr**, es mucho mas exhaustiva, enfocada de una manera más amplia y no a un simple vistazo. Cuenta con ejemplos concretos, lo que facilita el entendimiento y funcionamiento de las diferentes expresiones regulares. Su único, quizás, defecto podría ser que se encuentra en inglés, aunque si esto no supone un problema para la persona interesado es recomendable comenzar en esta página, ya que su utilidad a la alrga es mucho mayor que la vista en **Rip tutorial**.

<p align="center">
 Webs | A favor                      |       En contra
------------ | ---------------------------------| --------------------------------------
**Rip tutorial** | En castellano y fÃ¡cil de seguir| Tan solo toca los temas fundamentales y se queda en la superficie de las cosas
**Stringr** | MÃ¡s completa y desarrollada       | Se encuentra en ingÃ©s
        
</p>


## Recursos para R Markdown

Los documentos realizados en R Markdown resultan una alternativa a para aquellos que necesiten presentar tablas, gráficos o imágenes de forma ciertamente detallista que la disponible en otras modalidades, como es el caso del casi omnipresente Microsoft Word. Para conecer en profundidad las opciones disponibles podemos encontrar dos webs:

1. [R para Ciencia de Datos](https://es.r4ds.hadley.nz/r-markdown.html)
2. [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)

La primera de las dos webs presentadas, no pretende ser más que un primer contacto con las opciones disponibles en R Markdown para aquellos que comienzan a trabajar con R. Toca por encima los puntos más básicos, dando apenas unas pinceladas para que el interesado comience a familiarizarse con las opciones disponibles. Su punto fuerte podría ser el encontrarse en castellano, sin embargo la página no se centra solamente en los recursos de R Markdown, por lo que a la larga no es una web para tener de referencia.

La segunda opción, si bien en inglés, resulta de una mayor amplitud en cuanto a los recursos disponibles, siendo en esencia una guía bastante completa acerca del manejo de R Markdown.

R Markdown | A favor                      |       En contra
------------ | ---------------------------------| --------------------------------------
**R para Ciencia de Datos** | En castellano, buena estructura y bien documentada| Su objetivo es enseñar a un nivel básico, lo que a la larga se queda corto
**R Markdown: The Definitive Guide** | Buen desarrollo, estructura fácil de seguir y con utilidad a largo plazo | Se encuentra en inglés
        
</p>

# <span style="color:red"> Usando ggplot para mostrar el crecimiento mundial desde el 1000 d.c.</span>

Se obtiene la información requerida de [esta](https://en.wikipedia.org/wiki/World_population) direcciÃ³n. Obtenemos de esa manera los datos por continente del crecimiento mundial en los últimos 1000 años.

<center>
```{r poblacion, fig.align="center", echo=FALSE, message=FALSE, warning=FALSE, results = 'asis'}
url.poblacion <- "https://en.wikipedia.org/wiki/World_population"

tmp <- read_html(url.poblacion)

tmp <- html_nodes(tmp, "table")
#sapply(tmp, function(x) dim(html_table(x, fill = TRUE))) Mediante este comando encuentro la tabla que me interesa.

crecim <- html_table(tmp[[11]])
#Seleccionada la tabla toca limpiarla de datos no necesarios para nuestro trabajo.
crecim$Notes <- NULL
ultmilenio <- crecim[12:33,]
colnames(ultmilenio)[c(1,2,6,7)] <- c("Fecha","Mundo","N.America", "S.America")
ultmilenio$Mundo <- as.numeric(gsub("[,]| [.]","", ultmilenio$Mundo))
milcont <- ultmilenio[,-2]

#Cambio de nombre por unos mÃ¡s manejables.

pandoc.table(ultmilenio, caption = "Crecimiento Mundial, contado en millones", justify = "center")
```
</center>

Ahora procedemos a realizar un sencillo gráfico con los datos obtenidos.

<center>
```{r continente, fig.align="center", echo=FALSE, message=FALSE, warning=FALSE, results = 'asis'}
trab <- melt(milcont, id.vars = c("Fecha"))
colnames(trab)[c(2,3)] <-c("continente", "habitantes") 
trab$habitantes <- as.numeric(gsub("[,]| [.]","", trab$habitantes))
trab$Fecha <- as.numeric(gsub("[,]| [.]","", trab$Fecha))
ggplot(trab, aes(x = Fecha, y = habitantes)) + geom_line() + facet_wrap(~continente) + theme_linedraw()

```
</center>

Un gráfico un tanto más elegante que el anterior:

<center>
```{r grafico, fig.align="center", echo=FALSE, message=FALSE, warning=FALSE, results = 'asis'}
ggplot(trab, aes(x = Fecha, y = habitantes, colour = continente)) + geom_point() + geom_smooth() + 
  facet_grid(~ continente)+ ggtitle("Vistazo al crecimiento de la humanidad a nivel mundial") + 
  theme_classic() +
         labs(x = "Fechas de los datos", 
              y = "Habitantes en mll.", 
              colour = "Contienetes")
```
</center>

Podemos observar la comparaciÃ³n entre los contienetes, es destacable el hecho de que la poblaciÃ³n se ha mantenido con un crecimiento aparentemente constante en casi todos los continentes, exceptuando en Asia, aquÃ­ el crecimiento fue mucho mÃ¡s acusado que el resto del mundo. El resto de contienetes comienzan a tener un crecimiento mÃ¡s acelerado a partir del siglo XIX aproximadamente, con excepciÃ³n de OceanÃ­a la cual se encuentra casi despoblada si es comparada con cualquiera de las otras regiones del mundo.

# <span style="color:orange"> Mapa </span>

Puede comprobarse la utilidad del paquete <tmap> para realizar mapas interactivos.

<center>
```{r mapa, fig.align="center", echo=FALSE, message=FALSE, warning=FALSE, results = 'asis'}
data("World")
tmap_mode("view")
tm_shape(World) +
  tm_polygons("HPI")+
  tm_layout(bg.color = "skyblue", inner.margins = c(0, .02, .02, .02))

```
</center>

# <span style="color:orange"> Grafico Interactivo </span>
<center>
```{r interac, fig.align="center", echo=FALSE, message=FALSE, warning=FALSE, results = 'asis'}

plot_ly(data = ultmilenio, x = ~Fecha, y = ~Mundo, type = "scatter", color = I("red"), mode = "bar") %>%
  layout(title = 'Crecimiento a nivel mundial', 
         xaxis = list(title = 'Fechas'),
         yaxis = list(title = "Millones de personas"))

```
